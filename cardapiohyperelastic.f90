!--------------------------------------------------------------
!*** CHECKED:
!     CALLING SEGMENTS
!     VISCOBACKSTRESS
!     VISCOONETERM
!
!*** ATTENTION:
!*** IMPLEMENTATION IS MADE AS:
!*** INPUT IS CE! NOT E, NOT EE, CE!
!*** AND SCIENTIFIC NOTATION IS USED, NOT ENGINEERING
!*** HOWEVER, IMPLEMENTATION SHOULD BE MADE AS FOLLOWS:
!*** 
!*** SE=2*D[PSI,CE]
!*** SE[4:6]=0.5*SE[4:6]
!***
!*** DSEDCE=D[SE,CE]
!--->> NOT ---->> DSEDCE[1:6,4:6]=0.5*DSEDCE[1:6,4:6]
!--------------------------------------------------------------
SUBROUTINE PRECARDAPIOHYPERELASTIC(DTIME,ACTIVE,IHYPER,VAROLD,VAR,PRP,CEI,PSI,SE,DSEDCE)
  USE BASFUN
  IMPLICIT REAL(8)(A-H,O-Z)
  REAL(8)::PSI
  REAL(8),DIMENSION(6)::CE,CEI,ID,ACTIVE,SE,SEHYPER
  REAL(8),DIMENSION(*)::VAROLD,VAR,PRP
  REAL(8),DIMENSION(6,6)::DSEDCE,DSEHYPER,DQNEWDCE
!-----------------------------------------
!*** DRIVING FORCE
!*** COPY, SINCE ITERATION CAN OCCUR ON CE
!-----------------------------------------
  CE=CEI
!-----------------------------------
!*** DAMPING AND CHARACTERISTIC TIME
!-----------------------------------
  GAMMA=PRP(21)
  TAU=PRP(22)
!----------------------------------------
!*** CHOSES VISCOELASTICITY OR ELASTICITY
!----------------------------------------
  IF(ABS(GAMMA*TAU).GT.1.0D-25)THEN
     CALL CARDAPIOHYPERELASTIC(IHYPER,VAROLD,VAR,PRP,CE,PSI,SEHYPER,DSEHYPER)
     CALL VISCOBACKSTRESS(DTIME,GAMMA,TAU,CE,SEHYPER,DSEHYPER,VAROLD(40:45),VAR(40:45),DQNEWDCE)
     CALL VISCOONETERM(CE,SEHYPER,DSEHYPER,VAR(40:45),DQNEWDCE,SE,DSEDCE)
  ELSE
     CALL CARDAPIOHYPERELASTIC(IHYPER,VAROLD,VAR,PRP,CE,PSI,SE,DSEDCE)
  END IF
END SUBROUTINE PRECARDAPIOHYPERELASTIC


SUBROUTINE CARDAPIOHYPERELASTIC(IHYPER,VAROLD,VAR,PRP,CEI,PSI,SE,DSEDCE)
  USE BASFUN
  IMPLICIT REAL(8)(A-H,O-Z)
  REAL(8)::NU12,NU23,NU13,NUM,NUN
  INTEGER,PARAMETER::MITER=20
  REAL(8)::PSI,POISS
  REAL(8),DIMENSION(3)::M,A0
  REAL(8),DIMENSION(6)::DEQDCI,CE,DIF,DSDC33,ID,CE0,SE,SE0
  REAL(8),DIMENSION(*)::VAROLD,VAR,PRP,CEI
  REAL(8),DIMENSION(6,6)::DSEDCE,DSDC
  CE=CEI(1:6)
  ID=0.0D00
  DO I=1,3
     ID(I)=1.0D00
  END DO
  SELECT CASE(IHYPER)
  CASE(1)
     YOUNG=PRP(1)
     POISS=PRP(2)
     RMU=YOUNG/(2.0D00*(1.0D00+POISS))
     RLAMBDA=YOUNG*POISS/((1.0D00+POISS)*(1.0D00-2.0D00*POISS))
!     CALL SAINTVENANT(RMU,RLAMBDA,CE,PSI,SE,DSEDCE)
     A0=0.0D00
     A0(1)=1.0D00
!!     WRITE(*,*)"young,POISS",YOUNG,POISS
     CALL GUO2008(YOUNG,POISS,A0,CE,PSI,SE,DSEDCE)
!!     CALL NEOHOOKEANCOMPRESSIBLE(YOUNG,POISS,CE,PSI,SE,DSEDCE)
!!     CALL NEOHOOKEANINCOMPRESSIBLE(YOUNG,POISS,CE,PSI,SE,DSEDCE)
!!    CALL NEOHOOKEBONET2(YOUNG,POISS,CE,SE,DSEDCE)
!!    CALL COMPRESSIBLENEOHOOKEAN(RMU,RLAMBDA,CE,PSI,SE,DSEDCE)
  CASE(2)
     GOTO 555
     RPAR=0.6D00
!*** WRINKLES LIU
     EM=1.0D00
     EN=RPAR*EM
     NUM=0.3D00
     NUN=RPAR*NUM
     QPAR=1.0D00
     GMN=QPAR*EM/(2.0D00*(1.0D00+NUM))
     CALL ORTHOTROPIC36A(EM,NUM,NUN,NUM,EN,EN,GMN,GMN,GMN,CE,DSEDCE,SE)     
333  CONTINUE
     YOUNG=PRP(1)
     POISS=PRP(2)
     YOUNGL=YOUNG*0.5D00
     YOUNGT=YOUNG
     M=0.0D00
     PI=4.0D00*ATAN(1.0D00)
     ANG=PI/6.0D00
     M(1)=COS(ANG)
     M(2)=SIN(ANG)
     CALL MURPHY(YOUNGL,YOUNGT,POISS,M,CE,PSI,SE,DSEDCE)
     RETURN
555  CONTINUE
     YOUNG=PRP(1)
     POISS=PRP(2)
     YOUNGL=YOUNG
     YOUNGT=YOUNG*0.5D00
     G12=YOUNG/(2.0D00*(1.0D00+POISS))
     M=0.0D00
     PI=4.0D00*ATAN(1.0D00)
     ANG=0.0D00*PI/4.0D00
     M(1)=COS(ANG)
     M(2)=SIN(ANG)
     CALL ORTHOTROPIC36A(YOUNGL,POISS,POISS,POISS,YOUNGT,YOUNGT,G12,G12,G12,CE,DSEDCE,SE)
!!!     CALL ORTHOTROPIC36A(EM,NUM,NUN,NUM,EN,EN,GMN,GMN,GMN,CE,DSEDCE,SE)     
!!!     CALL MURPHY(YOUNGL,YOUNGT,POISS,M,CE,PSI,SE,DSEDCE)
     RETURN
     E1=1.0D00
     E2=0.5D00
     E3=0.5D00
     NU12=0.25D00
     NU13=0.25D00
     NU23=0.25D00
     G12=0.4D00
     G13=0.4D00
     G23=0.2D00
     CALL ORTHOTROPIC36A(E1,NU12,NU13,NU23,E2,E3,G12,G13,G23,CE,DSEDCE,SE)
!!     SE(1:3)=0.0D00
!!     SE(5:6)=0.0D00
!!     DSEDCE(1:6,1:3)=0.0D00
!!     DSEDCE(1:6,5:6)=0.0D00
  CASE(3)
     YOUNG=PRP(1)
     POISS=PRP(2)
     RCORT=YOUNG/(2.0D00*(1.0D00+POISS))
     RBULK=YOUNG/(3.0D00*(1.0D00-2.0D00*POISS))
     C1=RCORT*0.5D00
     C2=RCORT*0.5D00
     CALL MOONERIVLIN(C1,C2,RBULK,CE,PSI,SE,DSEDCE)
  END SELECT
END SUBROUTINE CARDAPIOHYPERELASTIC

SUBROUTINE NEOHOOKEANINCOMPRESSIBLE(YOUNG,POISS,CE,PSI,SE,DSEDCE)
  IMPLICIT NONE
  DOUBLE PRECISION V(143),YOUNG,POISS,CE(6),PSI,SE(6),DSEDCE(6,6)
  V(124)=CE(5)**2
  V(123)=CE(4)**2
  V(122)=YOUNG/(3D0-6D0*POISS)
  V(126)=V(122)/4D0
  V(121)=YOUNG/(2D0+2D0*POISS)
  V(120)=CE(2)*CE(3)-CE(6)**2
  V(131)=2D0*V(120)
  V(119)=(-2D0)*CE(6)
  V(118)=2D0*CE(5)
  V(117)=2D0*CE(4)
  V(125)=CE(5)*V(117)
  V(116)=CE(6)*V(117)-CE(2)*V(118)
  V(115)=CE(1)*CE(3)-V(124)
  V(133)=2D0*V(115)
  V(114)=CE(1)*CE(2)-V(123)
  V(134)=2D0*V(114)
  V(75)=-(CE(3)*V(117))+CE(6)*V(118)
  V(79)=CE(1)*V(119)+V(125)
  V(62)=V(121)/2D0
  V(56)=CE(1)*V(120)-CE(3)*V(123)-CE(2)*V(124)+CE(6)*V(125)
  V(130)=(-1D0)+V(56)
  V(71)=V(126)/V(56)**2
  V(80)=V(71)*V(79)
  V(78)=V(116)*V(71)
  V(135)=2D0*V(78)
  V(76)=V(71)*V(75)
  V(132)=2D0*V(76)
  V(74)=V(114)*V(71)
  V(72)=V(115)*V(71)
  V(69)=V(120)*V(71)
  V(59)=(V(126)*V(130))/V(56)
  V(138)=CE(3)*V(59)
  V(137)=CE(2)*V(59)
  V(136)=CE(1)*V(59)
  V(129)=-(V(117)*V(59))
  V(128)=-(V(118)*V(59))
  V(127)=V(119)*V(59)
  V(107)=V(127)+V(120)*V(80)
  V(103)=V(128)+V(115)*V(78)
  V(98)=V(129)+V(114)*V(76)
  V(82)=2D0*(V(138)+V(115)*V(69))
  V(83)=2D0*(V(137)+V(114)*V(69))
  V(85)=2D0*(V(136)+V(114)*V(72))
  V(100)=-V(127)+V(75)*V(78)
  V(101)=-V(128)+V(75)*V(80)
  V(106)=-V(129)+V(116)*V(80)
  PSI=((-3D0)+CE(1)+CE(2)+CE(3))*V(62)+(V(122)*(V(130)/2D0-DLOG(SQRT(V(56)))))/2D0
  SE(1)=2D0*(V(120)*V(59)+V(62))
  SE(2)=2D0*(V(115)*V(59)+V(62))
  SE(3)=2D0*(V(114)*V(59)+V(62))
  SE(4)=V(59)*V(75)
  SE(5)=V(116)*V(59)
  SE(6)=V(59)*V(79)
  DSEDCE(1,1)=V(131)*V(69)
  DSEDCE(1,2)=V(82)
  DSEDCE(1,3)=V(83)
  DSEDCE(1,4)=V(120)*V(132)
  DSEDCE(1,5)=V(131)*V(78)
  DSEDCE(1,6)=2D0*V(107)
  DSEDCE(2,1)=V(82)
  DSEDCE(2,2)=V(133)*V(72)
  DSEDCE(2,3)=V(85)
  DSEDCE(2,4)=V(115)*V(132)
  DSEDCE(2,5)=2D0*V(103)
  DSEDCE(2,6)=V(133)*V(80)
  DSEDCE(3,1)=V(83)
  DSEDCE(3,2)=V(85)
  DSEDCE(3,3)=V(134)*V(74)
  DSEDCE(3,4)=2D0*V(98)
  DSEDCE(3,5)=V(114)*V(135)
  DSEDCE(3,6)=V(134)*V(80)
  DSEDCE(4,1)=V(69)*V(75)
  DSEDCE(4,2)=V(72)*V(75)
  DSEDCE(4,3)=V(98)
  DSEDCE(4,4)=((-4D0)*V(138)+V(132)*V(75))/2D0
  DSEDCE(4,5)=V(100)
  DSEDCE(4,6)=V(101)
  DSEDCE(5,1)=V(116)*V(69)
  DSEDCE(5,2)=V(103)
  DSEDCE(5,3)=V(116)*V(74)
  DSEDCE(5,4)=V(100)
  DSEDCE(5,5)=(V(116)*V(135)-4D0*V(137))/2D0
  DSEDCE(5,6)=V(106)
  DSEDCE(6,1)=V(107)
  DSEDCE(6,2)=V(72)*V(79)
  DSEDCE(6,3)=V(74)*V(79)
  DSEDCE(6,4)=V(101)
  DSEDCE(6,5)=V(106)
  DSEDCE(6,6)=((-4D0)*V(136)+2D0*V(79)*V(80))/2D0
END SUBROUTINE NEOHOOKEANINCOMPRESSIBLE

SUBROUTINE NEOHOOKEANCOMPRESSIBLE(YOUNG,POISS,CE,PSI,SE,DSEDCE)
  IMPLICIT NONE
  DOUBLE PRECISION V(167),YOUNG,POISS,CE(6),PSI,SE(6),DSEDCE(6,6)
  V(154)=CE(5)**2
  V(153)=CE(4)**2
  V(152)=2D0*POISS
  V(151)=YOUNG/(2D0+V(152))
  V(150)=CE(2)*CE(3)-CE(6)**2
  V(149)=(-2D0)*CE(6)
  V(148)=2D0*CE(5)
  V(147)=2D0*CE(4)
  V(155)=CE(5)*V(147)
  V(146)=CE(6)*V(147)-CE(2)*V(148)
  V(145)=CE(1)*CE(3)-V(154)
  V(144)=CE(1)*CE(2)-V(153)
  V(74)=-(CE(3)*V(147))+CE(6)*V(148)
  V(76)=CE(1)*V(149)+V(155)
  V(63)=V(151)/2D0
  V(54)=((-2D0)*V(151)+YOUNG/(1D0-V(152)))/3D0
  V(162)=V(54)/2D0
  V(56)=CE(1)*V(150)-CE(3)*V(153)-CE(2)*V(154)+CE(6)*V(155)
  V(157)=2D0/V(56)
  V(84)=SQRT(V(56))
  V(156)=V(162)/V(84)**2
  V(78)=1D0/V(56)**2
  V(83)=-(V(76)*V(78))
  V(82)=-(V(146)*V(78))
  V(81)=-(V(74)*V(78))
  V(103)=V(156)*V(76)
  V(101)=V(146)*V(156)
  V(99)=V(156)*V(74)
  V(58)=DLOG(V(84))
  V(60)=-V(151)+V(54)*V(58)
  V(129)=V(157)*V(60)
  V(158)=(V(156)*V(157)-V(129)*V(56)*V(78))/4D0
  V(109)=(V(103)/V(56)+V(60)*V(83))/2D0
  V(161)=2D0*V(109)
  V(108)=(V(101)/V(56)+V(60)*V(82))/2D0
  V(160)=2D0*V(108)
  V(107)=(V(60)*V(81)+V(99)/V(56))/2D0
  V(159)=2D0*V(107)
  V(105)=V(145)*V(158)
  V(104)=V(150)*V(158)
  V(64)=V(60)/(2D0*V(56))
  V(137)=V(109)*V(150)+V(149)*V(64)
  V(133)=V(108)*V(145)-V(148)*V(64)
  V(127)=V(107)*V(144)-V(147)*V(64)
  V(111)=2D0*(V(104)*V(145)+CE(3)*V(64))
  V(112)=2D0*(V(104)*V(144)+CE(2)*V(64))
  V(114)=2D0*(V(105)*V(144)+CE(1)*V(64))
  V(116)=V(150)*V(159)
  V(117)=V(145)*V(159)
  V(119)=V(150)*V(160)
  V(121)=V(144)*V(160)
  V(123)=V(145)*V(161)
  V(124)=V(144)*V(161)
  V(130)=(CE(6)*V(129)+V(160)*V(74))/2D0
  V(131)=(CE(5)*V(129)+V(161)*V(74))/2D0
  V(136)=(CE(4)*V(129)+V(146)*V(161))/2D0
  PSI=V(151)*(((-3D0)+CE(1)+CE(2)+CE(3))/2D0-V(58))+V(162)*(V(58)*V(58))
  SE(1)=2D0*(V(63)+V(150)*V(64))
  SE(2)=2D0*(V(63)+V(145)*V(64))
  SE(3)=2D0*(V(63)+V(144)*V(64))
  SE(4)=V(64)*V(74)
  SE(5)=V(146)*V(64)
  SE(6)=V(64)*V(76)
  DSEDCE(1,1)=2D0*V(104)*V(150)
  DSEDCE(1,2)=V(111)
  DSEDCE(1,3)=V(112)
  DSEDCE(1,4)=V(116)
  DSEDCE(1,5)=V(119)
  DSEDCE(1,6)=2D0*V(137)
  DSEDCE(2,1)=V(111)
  DSEDCE(2,2)=2D0*V(105)*V(145)
  DSEDCE(2,3)=V(114)
  DSEDCE(2,4)=V(117)
  DSEDCE(2,5)=2D0*V(133)
  DSEDCE(2,6)=V(123)
  DSEDCE(3,1)=V(112)
  DSEDCE(3,2)=V(114)
  DSEDCE(3,3)=2D0*(V(144)*V(144))*V(158)
  DSEDCE(3,4)=2D0*V(127)
  DSEDCE(3,5)=V(121)
  DSEDCE(3,6)=V(124)
  DSEDCE(4,1)=V(116)/2D0
  DSEDCE(4,2)=V(117)/2D0
  DSEDCE(4,3)=V(127)
  DSEDCE(4,4)=(-(CE(3)*V(129))+V(159)*V(74))/2D0
  DSEDCE(4,5)=V(130)
  DSEDCE(4,6)=V(131)
  DSEDCE(5,1)=V(119)/2D0
  DSEDCE(5,2)=V(133)
  DSEDCE(5,3)=V(121)/2D0
  DSEDCE(5,4)=V(130)
  DSEDCE(5,5)=(-(CE(2)*V(129))+V(146)*V(160))/2D0
  DSEDCE(5,6)=V(136)
  DSEDCE(6,1)=V(137)
  DSEDCE(6,2)=V(123)/2D0
  DSEDCE(6,3)=V(124)/2D0
  DSEDCE(6,4)=V(131)
  DSEDCE(6,5)=V(136)
  DSEDCE(6,6)=(-(CE(1)*V(129))+V(161)*V(76))/2D0
END SUBROUTINE NEOHOOKEANCOMPRESSIBLE

!**************************************************************
!* AceGen    6.808 Linux (6 Sep 16)                           *
!*           Co. J. Korelc  2013           11 Jan 22 17:06:53 *
!**************************************************************
! User     : Full professional version
! Notebook : guo2008
! Evaluation time                 : 6 s     Mode  : Optimal
! Number of formulae              : 207     Method: Automatic
! Subroutine                      : guo2008 size: 3881
! Total size of Mathematica  code : 3881 subexpressions
! Total size of Fortran code      : 9278 bytes

!******************* S U B R O U T I N E **********************
SUBROUTINE guo2008(ed,et,a0,ce,psi,se,dsedce)
IMPLICIT NONE
LOGICAL b59,b77
DOUBLE PRECISION v(309),ed,et,a0(3),ce(6),psi,se(6),dsedce(6,6)
v(290)=a0(3)*ce(5)
v(289)=a0(2)*ce(4)
v(288)=2d0*a0(1)
v(281)=ce(5)**2
v(280)=ce(4)**2
v(279)=(ed*et)/((-2d0)*ed+5d0*et)
v(294)=v(279)/2d0
v(278)=(-0.6666666666666666d0)+(0.6666666666666666d0*ed)/et
v(293)=(-1d0)+v(278)
v(297)=v(293)*v(294)
v(283)=(-0.5d0)*1d0/v(278)
v(277)=ce(2)*ce(3)-ce(6)**2
v(276)=(-2d0)*ce(6)
v(275)=2d0*ce(5)
v(274)=2d0*ce(4)
v(282)=ce(5)*v(274)
v(273)=ce(6)*v(274)-ce(2)*v(275)
v(272)=ce(1)*ce(3)-v(281)
v(271)=ce(1)*ce(2)-v(280)
v(270)=a0(3)**2
v(269)=a0(3)*v(288)
v(268)=2d0*a0(2)
v(267)=a0(2)**2
v(266)=a0(1)*v(268)
v(265)=a0(1)**2
v(137)=a0(3)*v(268)
v(95)=-(ce(3)*v(274))+ce(6)*v(275)
v(97)=ce(1)*v(276)+v(282)
v(55)=v(278)
v(72)=1d0/(1d0+v(278))
v(58)=ce(1)*v(277)-ce(3)*v(280)-ce(2)*v(281)+ce(6)*v(282)
v(211)=1d0/v(58)**2
v(215)=v(211)*v(283)
v(105)=1d0/v(58)**0.15d1
v(284)=(-0.5d0)*v(105)
v(213)=v(105)*v(283)
v(111)=v(284)*v(97)
v(110)=v(273)*v(284)
v(109)=v(284)*v(95)
v(108)=v(271)*v(284)
v(107)=v(272)*v(284)
v(106)=v(277)*v(284)
v(98)=1d0/sqrt(v(58))
v(285)=v(98)/2d0
v(104)=v(285)*v(97)
v(103)=v(273)*v(285)
v(102)=v(285)*v(95)
v(101)=v(271)*v(285)
v(100)=v(272)*v(285)
v(99)=v(277)*v(285)
v(82)=v(293)+sqrt(v(58))
v(286)=v(82)/v(278)
v(216)=(0.75d0*v(286))/v(58)**0.25d1
v(303)=v(215)+v(216)
v(214)=-(v(283)/v(58))+v(213)*v(82)
v(117)=(v(111)*v(82)+v(104)*v(98))/v(278)
v(116)=(v(110)*v(82)+v(103)*v(98))/v(278)
v(115)=(v(109)*v(82)+v(102)*v(98))/v(278)
v(114)=(v(108)*v(82)+v(101)*v(98))/v(278)
v(113)=(v(107)*v(82)+v(100)*v(98))/v(278)
v(112)=(v(106)*v(82)+v(98)*v(99))/v(278)
v(68)=-v(278)+v(82)
v(62)=v(286)*v(98)
IF(((-1d0)+v(55)+sqrt(v(58)))/(v(55)*sqrt(v(58))).lt.0.1d0) THEN
 v(79)=1d0/v(278)**2
 v(299)=0.9999999999999999d2*v(79)
 v(119)=v(299)*v(82)
 v(124)=v(104)*v(119)
 v(123)=v(103)*v(119)
 v(122)=v(102)*v(119)
 v(121)=v(101)*v(119)
 v(120)=v(100)*v(119)
 v(118)=v(119)*v(99)
 v(80)=0.49999999999999994d2*v(79)*(v(82)*v(82))
 v(287)=v(211)*v(80)
 v(125)=20d0*v(112)+v(277)*v(287)-v(118)/v(58)
 v(127)=20d0*v(113)+v(272)*v(287)-v(120)/v(58)
 v(128)=20d0*v(114)+v(271)*v(287)-v(121)/v(58)
 v(129)=20d0*v(115)-v(122)/v(58)+v(287)*v(95)
 v(130)=20d0*v(116)+v(273)*v(287)-v(123)/v(58)
 v(131)=20d0*v(117)-v(124)/v(58)+v(287)*v(97)
 v(61)=(-0.3802585092994045d1)+20d0*v(62)-v(80)/v(58)
ELSE
 v(125)=v(112)/v(62)
 v(127)=v(113)/v(62)
 v(128)=v(114)/v(62)
 v(129)=v(115)/v(62)
 v(130)=v(116)/v(62)
 v(131)=v(117)/v(62)
 v(61)=dlog(v(62))
ENDIF
v(304)=v(61)*v(68)
v(63)=ce(6)*v(137)+ce(1)*v(265)+ce(2)*v(267)+ce(3)*v(270)+v(288)*(v(289)+v(290))
v(152)=1d0/v(63)**0.15d1
v(184)=(-0.25d0)*(v(152)*v(279))
v(164)=v(137)*v(184)
v(162)=v(184)*v(269)
v(160)=v(184)*v(266)
v(158)=v(184)*v(270)
v(156)=v(184)*v(267)
v(154)=v(184)*v(265)
v(138)=1d0/v(63)**2
v(292)=-(v(138)*v(58))
v(73)=v(58)/v(63)
v(142)=1d0/v(73)**0.15d1
v(291)=(-0.5d0)*v(142)
v(151)=v(291)*(v(137)*v(292)+v(97)/v(63))
v(149)=v(291)*(v(269)*v(292)+v(273)/v(63))
v(147)=v(291)*(v(266)*v(292)+v(95)/v(63))
v(145)=v(291)*(v(270)*v(292)+v(271)/v(63))
v(143)=v(291)*(v(267)*v(292)+v(272)/v(63))
v(140)=v(291)*(v(265)*v(292)+v(277)/v(63))
v(75)=1d0/sqrt(v(73))
v(298)=v(58)*v(75)
v(188)=(2d0*v(298))/v(63)**3
v(64)=1d0/sqrt(v(63))
v(70)=v(294)*v(64)
v(170)=v(164)*v(68)+v(104)*v(70)
v(169)=v(162)*v(68)+v(103)*v(70)
v(168)=v(160)*v(68)+v(102)*v(70)
v(167)=v(158)*v(68)+v(101)*v(70)
v(166)=v(156)*v(68)+v(100)*v(70)
v(165)=v(154)*v(68)+v(70)*v(99)
v(185)=(-2d0)*v(293)+v(304)
v(187)=(0.375d0*v(185)*v(279))/v(63)**0.25d1
v(83)=v(297)*v(72)
v(296)=v(75)*v(83)
v(295)=v(83)/v(63)
v(193)=v(137)*v(187)+v(184)*(v(104)*v(61)+v(131)*v(68))+v(83)*(v(137)*v(188)+v(138)*(-(v(151)*v(58))-v(75)*v(97)))
v(199)=v(193)*v(288)
v(192)=v(187)*v(269)+v(184)*(v(103)*v(61)+v(130)*v(68))+(v(188)*v(269)+v(138)*(-(v(149)*v(58))-v(273)*v(75)))*v(83)
v(198)=v(192)*v(288)
v(191)=v(187)*v(266)+v(184)*(v(102)*v(61)+v(129)*v(68))+v(83)*(v(188)*v(266)+v(138)*(-(v(147)*v(58))-v(75)*v(95)))
v(197)=v(191)*v(288)
v(190)=v(187)*v(270)+v(184)*(v(101)*v(61)+v(128)*v(68))+(v(188)*v(270)+v(138)*(-(v(145)*v(58))-v(271)*v(75)))*v(83)
v(196)=v(190)*v(288)
v(189)=v(187)*v(267)+v(184)*(v(100)*v(61)+v(127)*v(68))+(v(188)*v(267)+v(138)*(-(v(143)*v(58))-v(272)*v(75)))*v(83)
v(195)=v(189)*v(288)
v(186)=v(187)*v(265)+(v(188)*v(265)+v(138)*(-(v(140)*v(58))-v(277)*v(75)))*v(83)+v(184)*(v(125)*v(68)+v(61)*v(99))
v(194)=v(186)*v(288)
v(178)=-(v(138)*v(296))
v(69)=v(68)*v(70)
v(171)=v(154)*v(61)+v(125)*v(70)
v(172)=v(156)*v(61)+v(127)*v(70)
v(173)=v(158)*v(61)+v(128)*v(70)
v(174)=v(160)*v(61)+v(129)*v(70)
v(175)=v(162)*v(61)+v(130)*v(70)
v(176)=v(164)*v(61)+v(131)*v(70)
v(71)=v(61)*v(70)
v(177)=v(178)*v(265)+v(140)*v(295)
v(179)=v(178)*v(267)+v(143)*v(295)
v(180)=v(178)*v(270)+v(145)*v(295)
v(181)=v(178)*v(266)+v(147)*v(295)
v(182)=v(178)*v(269)+v(149)*v(295)
v(183)=v(137)*v(178)+v(151)*v(295)
v(74)=v(296)/v(63)
v(76)=v(184)*v(185)+v(297)*((-1d0)-((-1d0)+v(138)*v(298))*v(72))
v(89)=v(288)*v(76)
b77=((-1d0)+v(55)+sqrt(v(58)))/(v(55)*sqrt(v(58))).lt.0.1d0
IF(b77) THEN
 v(300)=v(69)*v(80)
 v(209)=((-2d0)*v(300))/v(58)**3
 v(207)=v(299)*v(69)
 v(208)=v(207)*v(211)*v(82)
 v(206)=-(v(207)/v(58))
 v(200)=20d0*v(165)
 v(201)=20d0*v(166)
 v(202)=20d0*v(167)
 v(203)=20d0*v(168)
 v(204)=20d0*v(169)
 v(205)=20d0*v(170)
 v(78)=20d0*v(69)
 v(171)=v(171)+v(208)*v(277)-(v(119)*v(165))/v(58)+v(206)*v(99)
 v(172)=v(172)+v(208)*v(272)-(v(119)*v(166)+v(100)*v(207))/v(58)
 v(173)=v(173)+v(208)*v(271)-(v(119)*v(167)+v(101)*v(207))/v(58)
 v(174)=v(174)-(v(119)*v(168)+v(102)*v(207))/v(58)+v(208)*v(95)
 v(175)=v(175)+v(208)*v(273)-(v(119)*v(169)+v(103)*v(207))/v(58)
 v(176)=v(176)-(v(119)*v(170)+v(104)*v(207))/v(58)+v(208)*v(97)
 v(71)=v(71)+v(206)*v(82)
 v(177)=v(177)+v(209)*v(277)+v(211)*(v(118)*v(69)+v(165)*v(80))
 v(179)=v(179)+v(209)*v(272)+v(211)*(v(120)*v(69)+v(166)*v(80))
 v(180)=v(180)+v(209)*v(271)+v(211)*(v(121)*v(69)+v(167)*v(80))
 v(181)=v(181)+v(211)*(v(122)*v(69)+v(168)*v(80))+v(209)*v(95)
 v(182)=v(182)+v(209)*v(273)+v(211)*(v(123)*v(69)+v(169)*v(80))
 v(183)=v(183)+v(211)*(v(124)*v(69)+v(170)*v(80))+v(209)*v(97)
 v(74)=v(211)*v(300)+v(74)
ELSE
 v(210)=1d0/v(62)**2
 v(301)=-(v(210)*v(69))
 v(200)=v(112)*v(301)+v(165)/v(62)
 v(201)=v(113)*v(301)+v(166)/v(62)
 v(202)=v(114)*v(301)+v(167)/v(62)
 v(203)=v(115)*v(301)+v(168)/v(62)
 v(204)=v(116)*v(301)+v(169)/v(62)
 v(205)=v(117)*v(301)+v(170)/v(62)
 v(78)=v(69)/v(62)
ENDIF
v(302)=v(71)/2d0
v(177)=v(177)+v(200)*v(214)+v(171)*v(285)+v(106)*v(302)+v(78)*(v(277)*v(303)+v(213)*v(99))
v(179)=v(179)+v(201)*v(214)+v(172)*v(285)+v(107)*v(302)+(v(100)*v(213)+v(272)*v(303))*v(78)
v(180)=v(180)+v(202)*v(214)+v(173)*v(285)+v(108)*v(302)+(v(101)*v(213)+v(271)*v(303))*v(78)
v(181)=v(181)+v(203)*v(214)+v(174)*v(285)+v(109)*v(302)+v(78)*(v(102)*v(213)+v(303)*v(95))
v(182)=v(182)+v(204)*v(214)+v(175)*v(285)+v(110)*v(302)+(v(103)*v(213)+v(273)*v(303))*v(78)
v(183)=v(183)+v(205)*v(214)+v(176)*v(285)+v(111)*v(302)+v(78)*(v(104)*v(213)+v(303)*v(97))
v(74)=v(74)+v(214)*v(78)+v(302)*v(98)
v(245)=-(v(275)*v(74))
v(243)=v(276)*v(74)
v(240)=-(v(274)*v(74))
v(226)=ce(1)*v(74)
v(224)=ce(2)*v(74)
v(220)=ce(3)*v(74)
psi=v(294)*(v(304)*v(64)+v(293)*(3d0-v(63)-2d0*v(64)+v(72)*(-ce(1)-ce(2)-ce(3)+v(63)+2d0*sqrt(v(73)))))
se(1)=2d0*(v(277)*v(74)+v(265)*v(76)-v(83))
se(2)=2d0*(v(272)*v(74)+v(267)*v(76)-v(83))
se(3)=2d0*(v(271)*v(74)+v(270)*v(76)-v(83))
se(4)=a0(2)*v(89)+v(74)*v(95)
se(5)=v(273)*v(74)+a0(3)*v(89)
se(6)=v(137)*v(76)+v(74)*v(97)
dsedce(1,1)=2d0*(v(186)*v(265)+v(177)*v(277))
dsedce(1,2)=2d0*(v(220)+v(189)*v(265)+v(179)*v(277))
dsedce(1,3)=2d0*(v(224)+v(190)*v(265)+v(180)*v(277))
dsedce(1,4)=2d0*(v(191)*v(265)+v(181)*v(277))
dsedce(1,5)=2d0*(v(192)*v(265)+v(182)*v(277))
dsedce(1,6)=2d0*(v(243)+v(193)*v(265)+v(183)*v(277))
dsedce(2,1)=2d0*(v(220)+v(186)*v(267)+v(177)*v(272))
dsedce(2,2)=2d0*(v(189)*v(267)+v(179)*v(272))
dsedce(2,3)=2d0*(v(226)+v(190)*v(267)+v(180)*v(272))
dsedce(2,4)=2d0*(v(191)*v(267)+v(181)*v(272))
dsedce(2,5)=2d0*(v(245)+v(192)*v(267)+v(182)*v(272))
dsedce(2,6)=2d0*(v(193)*v(267)+v(183)*v(272))
dsedce(3,1)=2d0*(v(224)+v(186)*v(270)+v(177)*v(271))
dsedce(3,2)=2d0*(v(226)+v(189)*v(270)+v(179)*v(271))
dsedce(3,3)=2d0*(v(190)*v(270)+v(180)*v(271))
dsedce(3,4)=2d0*(v(240)+v(191)*v(270)+v(181)*v(271))
dsedce(3,5)=2d0*(v(192)*v(270)+v(182)*v(271))
dsedce(3,6)=2d0*(v(193)*v(270)+v(183)*v(271))
dsedce(4,1)=a0(2)*v(194)+v(177)*v(95)
dsedce(4,2)=a0(2)*v(195)+v(179)*v(95)
dsedce(4,3)=a0(2)*v(196)+v(240)+v(180)*v(95)
dsedce(4,4)=a0(2)*v(197)-2d0*v(220)+v(181)*v(95)
dsedce(4,5)=a0(2)*v(198)-v(243)+v(182)*v(95)
dsedce(4,6)=a0(2)*v(199)-v(245)+v(183)*v(95)
dsedce(5,1)=a0(3)*v(194)+v(177)*v(273)
dsedce(5,2)=a0(3)*v(195)+v(245)+v(179)*v(273)
dsedce(5,3)=a0(3)*v(196)+v(180)*v(273)
dsedce(5,4)=a0(3)*v(197)-v(243)+v(181)*v(273)
dsedce(5,5)=a0(3)*v(198)-2d0*v(224)+v(182)*v(273)
dsedce(5,6)=a0(3)*v(199)-v(240)+v(183)*v(273)
dsedce(6,1)=v(137)*v(186)+v(243)+v(177)*v(97)
dsedce(6,2)=v(137)*v(189)+v(179)*v(97)
dsedce(6,3)=v(137)*v(190)+v(180)*v(97)
dsedce(6,4)=v(137)*v(191)-v(245)+v(181)*v(97)
dsedce(6,5)=v(137)*v(192)-v(240)+v(182)*v(97)
dsedce(6,6)=v(137)*v(193)-2d0*v(226)+v(183)*v(97)
END



!**************************************************************
!* ACEGEN    6.808 LINUX (6 SEP 16)                           *
!*           CO. J. KORELC  2013           10 FEB 21 09:09:09 *
!**************************************************************
! USER     : FULL PROFESSIONAL VERSION
! NOTEBOOK : ORTHOTROPIC
! EVALUATION TIME                 : 1 S     MODE  : OPTIMAL
! NUMBER OF FORMULAE              : 26      METHOD: AUTOMATIC
! SUBROUTINE                      : ORTHOTROPIC36 SIZE: 438
! TOTAL SIZE OF MATHEMATICA  CODE : 438 SUBEXPRESSIONS
! TOTAL SIZE OF FORTRAN CODE      : 1295 BYTES

!******************* S U B R O U T I N E **********************
SUBROUTINE ORTHOTROPIC36A(E1,NU12,NU13,NU23,E2,E3,G12,G13,G23,CE,DS,SE)
  IMPLICIT NONE
  INTEGER I01,I02
  DOUBLE PRECISION V(105),E1,NU12,NU13,NU23,E2,E3,G12,G13,G23,CE(6),DS(6,6),SE(6)
  V(100)=((-1D0)+CE(3))/2D0
  V(99)=((-1D0)+CE(2))/2D0
  V(98)=((-1D0)+CE(1))/2D0
  V(96)=E1*NU23
  V(94)=-(E3*NU13**2)
  V(93)=E2**2
  V(92)=NU12*NU23
  V(91)=E2*NU12
  V(90)=E3*NU13
  V(89)=E1**2
  V(88)=V(90)*(NU13+2D0*V(92))
  V(87)=E2-E3*NU23**2
  V(86)=E2*NU12**2
  V(60)=1D0/(E1*V(87)-E2*(V(86)+V(88)))
  V(95)=E2*V(60)
  V(97)=E3*V(95)
  V(62)=E1*V(95)
  V(59)=V(60)*V(87)*V(89)
  V(61)=V(62)*(NU23*V(90)+V(91))
  V(63)=E3*V(62)*(NU13+V(92))
  V(64)=V(60)*V(93)*(E1+V(94))
  V(65)=(NU13*V(91)+V(96))*V(97)
  V(67)=(E1-V(86))*V(97)
  SE(1)=V(100)*V(63)+V(59)*V(98)+V(61)*V(99)
  SE(2)=V(100)*V(65)+V(61)*V(98)+V(64)*V(99)
  SE(3)=V(100)*V(67)+V(63)*V(98)+V(65)*V(99)
  SE(4)=CE(4)*G12
  SE(5)=CE(5)*G13
  SE(6)=CE(6)*G23
  DS(1,1)=V(59)/2D0
  DS(1,2)=V(61)/2D0
  DS(1,3)=V(63)/2D0
  DS(1,4)=0D0
  DS(1,5)=0D0
  DS(1,6)=0D0
  DS(2,2)=V(64)/2D0
  DS(2,3)=V(65)/2D0
  DS(2,4)=0D0
  DS(2,5)=0D0
  DS(2,6)=0D0
  DS(3,3)=V(67)/2D0
  DS(3,4)=0D0
  DS(3,5)=0D0
  DS(3,6)=0D0
  DS(4,4)=G12
  DS(4,5)=0D0
  DS(4,6)=0D0
  DS(5,5)=G13
  DS(5,6)=0D0
  DS(6,6)=G23
  DO I01=2,6
     DO I02=1,I01-1
        DS(I01,I02)=DS(I02,I01)
     ENDDO
  ENDDO
END SUBROUTINE ORTHOTROPIC36A

!**************************************************************
!* ACEGEN    6.808 LINUX (6 SEP 16)                           *
!*           CO. J. KORELC  2013           3 JUL 20 15:04:47  *
!**************************************************************
! USER     : FULL PROFESSIONAL VERSION
! NOTEBOOK : SAINTVENANT
! EVALUATION TIME                 : 25 S    MODE  : OPTIMAL
! NUMBER OF FORMULAE              : 8       METHOD: AUTOMATIC
! SUBROUTINE                      : SAINTVENANT SIZE: 172
! TOTAL SIZE OF MATHEMATICA  CODE : 172 SUBEXPRESSIONS
! TOTAL SIZE OF FORTRAN CODE      : 806 BYTES

!******************* S U B R O U T I N E **********************
SUBROUTINE SAINTVENANT(MU,LAMBDA,C,PSI,S,DSDC)
  IMPLICIT NONE
  INTEGER I01,I02
  DOUBLE PRECISION V(71),MU,LAMBDA,C(6),PSI,S(6),DSDC(6,6)
  V(66)=(-3D0)+C(1)+C(2)+C(3)
  V(65)=LAMBDA/2D0
  V(55)=V(65)*V(66)
  V(60)=MU+V(65)
  PSI=PSI
  S(1)=((-1D0)+C(1))*MU+V(55)
  S(2)=((-1D0)+C(2))*MU+V(55)
  S(3)=((-1D0)+C(3))*MU+V(55)
  S(4)=C(4)*MU
  S(5)=C(5)*MU
  S(6)=C(6)*MU
  DSDC(1,1)=V(60)
  DSDC(1,2)=V(65)
  DSDC(1,3)=V(65)
  DSDC(1,4)=0D0
  DSDC(1,5)=0D0
  DSDC(1,6)=0D0
  DSDC(2,2)=V(60)
  DSDC(2,3)=V(65)
  DSDC(2,4)=0D0
  DSDC(2,5)=0D0
  DSDC(2,6)=0D0
  DSDC(3,3)=V(60)
  DSDC(3,4)=0D0
  DSDC(3,5)=0D0
  DSDC(3,6)=0D0
  DSDC(4,4)=MU
  DSDC(4,5)=0D0
  DSDC(4,6)=0D0
  DSDC(5,5)=MU
  DSDC(5,6)=0D0
  DSDC(6,6)=MU
  DO I01=2,6
     DO I02=1,I01-1
        DSDC(I01,I02)=DSDC(I02,I01)
     ENDDO
  ENDDO
END SUBROUTINE SAINTVENANT

!**************************************************************
!* ACEGEN    6.808 LINUX (6 SEP 16)                           *
!*           CO. J. KORELC  2013           22 JUL 21 19:12:59 *
!**************************************************************
! USER     : FULL PROFESSIONAL VERSION
! NOTEBOOK : MURPHY
! EVALUATION TIME                 : 8 S     MODE  : OPTIMAL
! NUMBER OF FORMULAE              : 227     METHOD: AUTOMATIC
! SUBROUTINE                      : MURPHY SIZE: 3945
! TOTAL SIZE OF MATHEMATICA  CODE : 3945 SUBEXPRESSIONS
! TOTAL SIZE OF FORTRAN CODE      : 9217 BYTES

!******************* S U B R O U T I N E **********************
SUBROUTINE MURPHY(YOUNGL,YOUNGT,POISS,M,CE,PSI,S,DS)
  IMPLICIT NONE
  DOUBLE PRECISION V(371),YOUNGL,YOUNGT,POISS,M(3),CE(6),PSI,S(6),DS(6,6)
  V(349)=M(2)*M(3)
  V(339)=CE(1)+CE(2)
  V(336)=CE(2)+CE(3)
  V(334)=CE(1)+CE(3)
  V(352)=CE(2)+V(334)
  V(328)=CE(6)*V(336)
  V(327)=CE(4)*CE(5)
  V(331)=V(327)+V(328)
  V(326)=CE(4)*V(339)
  V(325)=CE(5)*V(334)
  V(317)=CE(4)*M(1)
  V(315)=M(1)*M(3)
  V(313)=CE(6)*M(3)
  V(304)=CE(3)*CE(4)
  V(303)=-(CE(2)*CE(5))
  V(302)=CE(2)*CE(3)
  V(301)=CE(6)**2
  V(300)=-(CE(5)*CE(6))
  V(333)=-V(300)+V(326)
  V(299)=CE(4)*CE(6)
  V(332)=V(299)+V(325)
  V(298)=2D0*CE(6)
  V(297)=2D0*CE(4)
  V(296)=CE(6)*V(297)
  V(295)=2D0*CE(5)
  V(323)=V(295)*V(315)
  V(316)=V(295)*V(315)
  V(294)=2D0*M(2)
  V(324)=V(294)*V(317)
  V(318)=V(294)*V(317)
  V(314)=V(294)*V(313)
  V(293)=CE(1)*CE(3)
  V(292)=CE(5)**2
  V(291)=CE(4)*V(295)
  V(290)=CE(1)*CE(2)
  V(289)=CE(4)**2
  V(288)=CE(3)**2
  V(287)=CE(2)**2
  V(286)=CE(1)**2
  V(285)=M(3)**2
  V(310)=CE(3)*V(285)
  V(284)=M(2)**2
  V(311)=CE(2)*V(284)
  V(283)=M(1)**2
  V(312)=CE(1)*V(283)
  V(282)=1D0/(1D0+POISS)
  V(309)=V(282)/2D0
  V(281)=YOUNGL/(6D0-12D0*POISS)
  V(121)=-V(289)+V(290)
  V(120)=-V(292)+V(293)
  V(219)=V(310)+V(311)+V(312)+V(314)+V(316)+V(318)
  V(123)=-(CE(2)*V(295))+V(296)
  V(122)=CE(6)*V(295)-CE(3)*V(297)
  V(125)=V(291)-CE(1)*V(298)
  V(101)=-V(301)+V(302)
  V(61)=CE(1)*V(101)+CE(5)*(V(299)+V(303))-CE(4)*(V(300)+V(304))
  V(308)=SQRT(V(61))
  V(146)=1D0/V(61)**0.16666666666666669D1
  V(305)=(-2D0/3D0)*V(146)
  V(152)=V(125)*V(305)
  V(151)=V(123)*V(305)
  V(157)=CE(3)*V(151)
  V(150)=V(122)*V(305)
  V(168)=CE(1)*V(150)
  V(162)=CE(2)*V(150)
  V(156)=CE(3)*V(150)
  V(149)=V(121)*V(305)
  V(167)=CE(1)*V(149)
  V(161)=CE(2)*V(149)
  V(148)=V(120)*V(305)
  V(166)=CE(1)*V(148)
  V(154)=CE(3)*V(148)
  V(147)=V(101)*V(305)
  V(357)=CE(1)*V(147)
  V(159)=CE(2)*V(147)
  V(153)=CE(3)*V(147)
  V(133)=1D0/V(61)**0.13333333333333333D1
  V(306)=(-1D0/3D0)*V(133)
  V(139)=V(125)*V(306)
  V(138)=V(123)*V(306)
  V(137)=V(122)*V(306)
  V(136)=V(121)*V(306)
  V(135)=V(120)*V(306)
  V(134)=V(101)*V(306)
  V(126)=1D0/V(308)
  V(342)=V(126)*V(281)
  V(307)=V(126)/2D0
  V(132)=V(125)*V(307)
  V(131)=V(123)*V(307)
  V(130)=V(122)*V(307)
  V(129)=V(121)*V(307)
  V(128)=V(120)*V(307)
  V(127)=V(101)*V(307)
  V(93)=(-1D0)+V(308)
  V(224)=-((V(281)*V(93))/V(308)**2)
  V(338)=V(224)+V(342)
  V(56)=V(309)*YOUNGT
  V(225)=V(56)/2D0
  V(141)=V(135)*V(225)
  V(140)=V(134)*V(225)
  V(58)=V(309)*YOUNGL
  V(89)=V(56)-4D0*V(58)+YOUNGL
  V(320)=V(89)/4D0
  V(79)=V(56)-V(58)
  V(340)=-(V(283)*V(79))
  V(330)=(-0.5D0)*V(79)
  V(329)=-(M(2)*V(79))
  V(240)=-(V(310)*V(79))
  V(238)=-(V(311)*V(79))
  V(59)=1D0/V(61)**0.3333333333333333D0
  V(341)=2D0*V(59)
  V(177)=M(3)*V(59)
  V(175)=M(1)*V(59)
  V(319)=M(3)*V(175)
  V(202)=(V(138)*V(310)+V(138)*V(311)+V(138)*V(312)+V(138)*V(314)+V(138)*V(316)+V(138)*V(318)+2D0*V(319))*V(320)
  V(174)=M(2)*V(59)
  V(322)=M(1)*V(174)
  V(321)=M(3)*V(174)
  V(203)=V(320)*(V(139)*V(310)+V(139)*V(311)+V(139)*V(312)+V(139)*V(314)+V(139)*V(295)*V(315)+V(139)*V(294)*V(317)+2D0*V&
       &(321))
  V(201)=V(320)*(V(137)*V(310)+V(137)*V(311)+V(137)*V(312)+V(137)*V(314)+V(137)*V(295)*V(315)+V(137)*V(294)*V(317)+2D0*V&
       &(322))
  V(200)=V(320)*(M(3)*V(177)+V(136)*V(310)+V(136)*V(311)+V(136)*V(312)+V(136)*V(314)+V(136)*V(323)+V(136)*V(324))
  V(199)=V(320)*(M(2)*V(174)+V(135)*V(310)+V(135)*V(311)+V(135)*V(312)+V(135)*V(314)+V(135)*V(323)+V(135)*V(324))
  V(198)=(M(1)*V(175)+V(134)*V(310)+V(134)*V(311)+V(134)*V(312)+V(134)*V(314)+V(134)*V(295)*V(315)+V(134)*V(294)*V(317)&
       &)*V(320)
  V(103)=V(225)*V(59)
  V(62)=1D0/V(61)**0.6666666666666666D0
  V(363)=2D0*V(62)
  V(361)=-(V(62)*V(79))
  V(236)=V(340)*V(62)
  V(165)=V(357)+V(62)
  V(160)=CE(2)*V(148)+V(62)
  V(155)=CE(3)*V(149)+V(62)
  V(114)=CE(3)*V(62)
  V(113)=CE(2)*V(62)
  V(110)=CE(1)*V(62)
  V(65)=V(219)*V(59)
  V(90)=(-1D0)+V(65)
  V(68)=V(289)*V(62)
  V(70)=V(292)*V(62)
  V(71)=V(332)*V(62)
  V(72)=V(333)*V(62)
  V(73)=V(331)*V(62)
  V(75)=V(301)*V(62)
  V(80)=(V(284)+V(285))*V(330)
  V(81)=M(3)*V(329)
  V(229)=CE(6)*V(81)
  V(181)=V(148)*V(229)
  V(358)=V(141)+V(181)
  V(180)=V(147)*V(229)
  V(343)=V(140)+V(180)
  V(106)=V(229)*V(62)
  V(82)=M(1)*V(329)
  V(347)=CE(5)*V(82)
  V(226)=CE(4)*V(82)
  V(359)=V(226)+V(238)
  V(186)=V(147)*V(226)
  V(104)=V(226)*V(62)
  V(83)=-(V(315)*V(79))
  V(348)=CE(4)*V(83)
  V(351)=V(347)+V(348)
  V(366)=V(351)+V(336)*V(81)
  V(230)=CE(5)*V(83)
  V(350)=V(230)+V(240)
  V(362)=V(229)+V(350)
  V(192)=V(147)*V(230)
  V(107)=V(230)*V(62)
  V(354)=V(103)+V(107)
  V(85)=(V(283)+V(285))*V(330)
  V(244)=V(295)*V(85)
  V(346)=V(244)+CE(4)*V(81)+CE(6)*V(82)
  V(88)=(V(283)+V(284))*V(330)
  V(242)=V(297)*V(88)
  V(345)=V(242)+CE(5)*V(81)+CE(6)*V(83)
  V(218)=-((-(V(283)*V(286))-V(284)*V(287)-V(285)*V(288))*V(330))+V(301)*V(80)+V(331)*V(81)+V(333)*V(82)+V(332)*V(83)+V&
       &(292)*V(85)+V(289)*V(88)
  V(223)=((10D0/9D0)*V(218))/V(61)**0.26666666666666666D1
  V(91)=V(79)+V(320)*V(90)
  V(360)=V(199)*V(59)+V(135)*V(91)
  V(356)=V(283)*V(91)
  V(355)=V(284)*V(91)
  V(353)=V(285)*V(91)
  V(344)=V(198)*V(59)+V(134)*V(91)
  V(335)=2D0*V(91)
  V(233)=M(1)*V(335)
  V(217)=V(225)*V(352)+V(219)*V(91)
  V(222)=((4D0/9D0)*V(217))/V(61)**0.23333333333333334D1
  V(337)=V(222)+V(223)
  V(235)=V(125)*V(337)+V(132)*V(338)+V(306)*(V(203)*V(219)+V(335)*V(349))+V(305)*(V(366)+V(298)*V(80))
  V(234)=(V(202)*V(219)+M(3)*V(233))*V(306)+V(123)*V(337)+V(131)*V(338)+V(305)*(V(346)+V(334)*V(83))
  V(232)=(V(201)*V(219)+M(2)*V(233))*V(306)+V(122)*V(337)+V(130)*V(338)+V(305)*(V(345)+V(339)*V(82))
  V(231)=V(121)*V(337)+V(129)*V(338)+V(306)*(V(200)*V(219)+V(225)+V(353))+V(305)*V(362)
  V(227)=V(120)*V(337)+V(128)*V(338)+V(306)*(V(199)*V(219)+V(225)+V(355))+V(305)*(V(229)+V(359))
  V(220)=V(101)*V(337)+V(127)*V(338)+V(305)*(V(226)+V(230)+CE(1)*V(340))+V(306)*(V(198)*V(219)+V(225)+V(356))
  V(208)=V(138)*V(335)+V(202)*V(341)
  V(207)=V(137)*V(335)+V(201)*V(341)
  V(213)=M(1)*V(207)
  V(206)=V(136)*V(335)+V(200)*V(341)
  V(212)=M(1)*V(206)
  V(205)=V(135)*V(335)+V(199)*V(341)
  V(211)=M(1)*V(205)
  V(204)=V(134)*V(335)+V(198)*V(341)
  V(210)=M(1)*V(204)
  V(115)=V(335)*V(59)
  V(111)=M(1)*V(115)
  V(100)=V(218)*V(305)+V(217)*V(306)+V(342)*V(93)
  V(365)=CE(3)*V(100)
  V(364)=CE(2)*V(100)
  V(271)=-(V(100)*V(297))
  V(264)=-(V(100)*V(295))
  V(248)=-(CE(1)*V(100))
  V(276)=V(248)+V(62)*V(80)
  V(239)=2D0*(V(186)+V(120)*V(220)+V(147)*V(238)+V(343)+V(284)*V(344)+V(365))
  V(241)=2D0*(V(192)+V(121)*V(220)+V(147)*V(240)+V(343)+V(285)*V(344)+V(364))
  V(243)=M(2)*V(210)+V(122)*V(220)+V(147)*V(345)+(V(159)+V(165))*V(82)
  V(245)=M(3)*V(210)+V(123)*V(220)+V(147)*V(346)+(V(153)+V(165))*V(83)
  V(246)=V(220)*V(291)+V(147)*V(347)+V(147)*V(348)+V(204)*V(349)+V(298)*(-V(100)-CE(1)*V(220)+V(147)*V(80))+(V(153)+V(159&
       &))*V(81)
  V(249)=2D0*(V(121)*V(227)-V(248)+V(148)*V(350)+V(358)+V(285)*V(360))
  V(250)=M(2)*V(211)+V(122)*V(227)+V(148)*V(345)+(V(160)+V(166))*V(82)
  V(251)=M(3)*V(211)+V(123)*V(227)+V(264)+V(148)*V(346)+(V(154)+V(166))*V(83)
  V(252)=V(227)*V(291)+V(205)*V(349)+V(148)*V(351)+V(298)*(-(CE(1)*V(227))+V(148)*V(80))+(V(154)+V(160))*V(81)
  V(254)=M(2)*V(212)+V(122)*V(231)+V(271)+V(149)*V(345)+(V(161)+V(167))*V(82)
  V(255)=M(3)*V(212)+V(123)*V(231)+V(149)*V(346)+(V(155)+V(167))*V(83)
  V(256)=V(231)*V(291)+V(206)*V(349)+V(149)*V(351)+V(298)*(-(CE(1)*V(231))+V(149)*V(80))+(V(155)+V(161))*V(81)
  V(262)=M(3)*V(213)+V(123)*V(232)+V(100)*V(298)+V(150)*V(346)+V(62)*V(81)+(V(156)+V(168))*V(83)
  V(265)=-V(264)+V(232)*V(291)+V(207)*V(349)+V(150)*V(351)+V(298)*(-(CE(1)*V(232))+V(150)*V(80))+(V(156)+V(162))*V(81)+V&
       &(62)*V(83)
  V(272)=-V(271)+V(234)*V(291)+V(208)*V(349)+V(151)*V(351)+V(298)*(-(CE(1)*V(234))+V(151)*V(80))+(CE(2)*V(151)+V(157))*V&
       &(81)+V(62)*V(82)
  PSI=V(225)*((-3D0)+V(352)*V(59))-V(330)*((-1D0)+2D0*V(65)-M(1)*(M(1)*(V(286)*V(62)+V(68)+V(70))+M(3)*V(71)+M(2)*V(72))&
       &-M(2)*(M(1)*V(72)+M(3)*V(73)+M(2)*(V(287)*V(62)+V(68)+V(75)))-M(3)*(M(1)*V(71)+M(2)*V(73)+M(3)*(V(288)*V(62)+V(70)+V(75&
       &))))+(V(89)*(V(90)*V(90)))/8D0+V(281)*(V(93)*V(93))
  S(1)=2D0*(V(100)*V(101)+V(104)+CE(1)*V(236)+V(354)+V(356)*V(59))
  S(2)=2D0*(V(103)+V(104)+V(106)+V(100)*V(120)+V(355)*V(59)+V(238)*V(62))
  S(3)=2D0*(V(106)+V(100)*V(121)+V(354)+V(353)*V(59)+V(240)*V(62))
  S(4)=M(2)*V(111)+V(100)*V(122)+V(345)*V(62)+(V(110)+V(113))*V(82)
  S(5)=M(3)*V(111)+V(100)*V(123)+V(346)*V(62)+(V(110)+V(114))*V(83)
  S(6)=V(100)*V(291)+V(276)*V(298)+V(115)*V(349)+V(351)*V(62)+(V(113)+V(114))*V(81)
  DS(1,1)=2D0*(V(140)+V(186)+V(192)+V(101)*V(220)+V(236)+V(283)*(V(344)-V(357)*V(79)))
  DS(1,2)=V(239)
  DS(1,3)=V(241)
  DS(1,4)=2D0*V(243)
  DS(1,5)=2D0*V(245)
  DS(1,6)=2D0*V(246)
  DS(2,1)=V(239)
  DS(2,2)=2D0*(V(120)*V(227)+V(358)+V(148)*V(359)+V(284)*(V(360)+V(361)))
  DS(2,3)=V(249)
  DS(2,4)=2D0*V(250)
  DS(2,5)=2D0*V(251)
  DS(2,6)=2D0*V(252)
  DS(3,1)=V(241)
  DS(3,2)=V(249)
  DS(3,3)=2D0*(V(136)*V(225)+V(121)*V(231)+V(149)*V(362)+V(285)*(V(361)+V(200)*V(59)+V(136)*V(91)))
  DS(3,4)=2D0*V(254)
  DS(3,5)=2D0*V(255)
  DS(3,6)=2D0*V(256)
  DS(4,1)=V(243)
  DS(4,2)=V(250)
  DS(4,3)=V(254)
  DS(4,4)=M(2)*V(213)+V(122)*V(232)+V(150)*V(345)-2D0*V(365)+(V(162)+V(168))*V(82)+V(363)*V(88)
  DS(4,5)=V(262)
  DS(4,6)=V(265)
  DS(5,1)=V(245)
  DS(5,2)=V(251)
  DS(5,3)=V(255)
  DS(5,4)=V(262)
  DS(5,5)=V(123)*V(234)+V(208)*V(315)+V(151)*V(346)-2D0*V(364)+(CE(1)*V(151)+V(157))*V(83)+V(363)*V(85)
  DS(5,6)=V(272)
  DS(6,1)=V(246)
  DS(6,2)=V(252)
  DS(6,3)=V(256)
  DS(6,4)=V(265)
  DS(6,5)=V(272)
  DS(6,6)=2D0*V(276)+V(235)*V(291)+(V(139)*V(335)+V(203)*V(341))*V(349)+V(152)*V(366)+V(298)*(-(CE(1)*V(235))+V(152)*V(80&
       &))
END SUBROUTINE MURPHY


SUBROUTINE MOONERIVLIN(C1,C2,RBULK,C,PSI,S,DSDC)
  IMPLICIT NONE
  DOUBLE PRECISION V(238),C1,C2,RBULK,C(6),PSI,S(6),DSDC(6,6)
  V(233)=C(4)*C(5)
  V(229)=-(C2*C(3))
  V(227)=(-2D0)*C(1)
  V(225)=(-2D0)*C(2)
  V(221)=RBULK/2D0
  V(215)=-C(3)**2
  V(214)=-C(2)**2
  V(213)=-C(1)**2
  V(211)=-(C(4)*(C(3)*C(4)-C(5)*C(6)))
  V(210)=C(5)*(-(C(2)*C(5))+C(4)*C(6))
  V(209)=C(2)*C(3)
  V(208)=C(6)**2
  V(207)=2D0*C(6)
  V(206)=C(1)*C(3)
  V(205)=C(5)**2
  V(204)=2D0*C(5)
  V(203)=C(1)*C(2)
  V(202)=C(4)**2
  V(201)=2D0*C(4)
  V(200)=C(1)+C(2)+C(3)
  V(220)=C2*V(200)
  V(119)=2D0*V(200)
  V(86)=-V(202)+V(203)
  V(84)=-V(205)+V(206)
  V(90)=C(6)*V(201)-C(2)*V(204)
  V(88)=-(C(3)*V(201))+C(6)*V(204)
  V(68)=-V(208)+V(209)
  V(216)=SQRT(V(210)+V(211)+C(1)*V(68))
  V(82)=1D0/V(216)
  V(212)=V(82)/2D0
  V(92)=(C(5)*V(201)-C(1)*V(207))*V(212)
  V(91)=V(212)*V(90)
  V(89)=V(212)*V(88)
  V(87)=V(212)*V(86)
  V(85)=V(212)*V(84)
  V(83)=V(212)*V(68)
  V(62)=(V(200)*V(200))-2D0*V(202)-2D0*V(205)-2D0*V(208)+V(213)+V(214)+V(215)
  V(144)=1D0/V(216)**0.16666666666666669D1
  V(123)=((14D0/9D0)*C2*V(62))/V(216)**0.33333333333333337D1
  V(122)=((10D0/9D0)*C1*V(200))/V(216)**0.26666666666666666D1
  V(116)=(-2D0/3D0)*C1*V(144)
  V(100)=1D0/V(216)**0.23333333333333334D1
  V(218)=(-4D0/3D0)*V(100)
  V(117)=(-2D0/3D0)*C2*V(100)
  V(223)=(-2D0)*V(117)
  V(106)=V(218)*V(92)
  V(217)=C2*V(106)
  V(157)=V(200)*V(217)+V(116)*V(92)
  V(112)=(-2D0)*V(217)
  V(105)=V(218)*V(91)
  V(219)=C2*V(105)
  V(155)=V(200)*V(219)+V(116)*V(91)
  V(111)=(-2D0)*V(219)
  V(104)=V(218)*V(89)
  V(224)=-(C2*V(104))
  V(153)=V(104)*V(220)+V(116)*V(89)
  V(103)=V(218)*V(87)
  V(102)=V(218)*V(85)
  V(101)=V(218)*V(83)
  V(228)=-(C2*V(101))
  V(94)=1D0/V(216)**2
  V(99)=-(V(92)*V(94))
  V(98)=-(V(91)*V(94))
  V(97)=-(V(89)*V(94))
  V(96)=-(V(87)*V(94))
  V(95)=-(V(85)*V(94))
  V(93)=-(V(83)*V(94))
  V(114)=RBULK*V(212)
  V(222)=2D0*V(114)+V(122)+V(123)
  V(65)=1D0/V(216)**0.13333333333333333D1
  V(146)=-(C2*V(65))
  V(149)=-V(146)+V(102)*V(220)+V(116)*V(85)
  V(147)=-V(146)+V(101)*V(220)+V(116)*V(83)
  V(76)=2D0*V(146)
  V(64)=1D0/V(216)**0.6666666666666666D0
  V(61)=(-1D0)+V(216)
  V(124)=V(221)*V(61)
  V(137)=V(207)*V(223)+V(222)*V(92)+V(124)*V(99)
  V(232)=V(137)*V(82)
  V(60)=V(221)*DLOG(V(216))
  V(63)=V(116)*V(200)+V(60)+V(114)*V(61)+V(117)*V(62)
  V(226)=V(63)/2D0
  V(192)=V(233)*V(63)
  V(143)=(V(232)+V(63)*V(99))/2D0
  V(190)=V(157)-C(3)*V(217)+V(143)*V(86)
  V(189)=V(157)-C(2)*V(217)+V(143)*V(84)
  V(142)=(V(63)*V(98)+V(82)*(V(204)*V(223)+V(222)*V(91)+V(124)*V(98)))/2D0
  V(184)=V(155)-C(3)*V(219)+V(142)*V(86)
  V(182)=V(155)-C(1)*V(219)+V(142)*V(68)
  V(141)=(V(63)*V(97)+V(82)*(V(201)*V(223)+V(222)*V(89)+V(124)*V(97)))/2D0
  V(175)=V(153)+C(2)*V(224)+V(141)*V(84)
  V(174)=V(153)+C(1)*V(224)+V(141)*V(68)
  V(139)=V(226)*V(95)+V(212)*(V(116)+V(117)*(V(119)+V(225))+V(222)*V(85)+V(124)*V(95))
  V(138)=V(226)*V(93)+V(212)*(V(116)+V(117)*(V(119)+V(227))+V(222)*V(83)+V(124)*V(93))
  V(70)=V(226)*V(82)
  V(231)=C(2)*V(70)
  V(230)=C(3)*V(70)
  V(186)=-(V(201)*V(70))
  V(180)=-(V(204)*V(70))
  V(183)=V(155)+V(180)-C(2)*V(219)+V(142)*V(84)
  V(178)=-(V(207)*V(70))
  V(188)=V(157)+V(178)-C(1)*V(217)+V(143)*V(68)
  V(176)=V(153)+V(186)+C(3)*V(224)+V(141)*V(86)
  V(162)=-(C(1)*V(70))
  V(191)=V(146)+V(162)
  V(66)=-(V(146)*V(200))+C1*V(64)
  V(159)=2D0*(V(147)+C(2)*V(228)+V(230)+V(138)*V(84))
  V(160)=2D0*(V(147)+C(3)*V(228)+V(231)+V(138)*V(86))
  V(163)=2D0*(V(149)-V(162)+V(102)*V(229)+V(139)*V(86))
  V(179)=C(4)*V(111)-V(178)+V(142)*V(88)
  V(181)=C(4)*V(112)-V(180)+V(143)*V(88)
  V(187)=C(5)*V(112)-V(186)+V(143)*V(90)
  PSI=V(60)*V(61)+C1*((-3D0)+V(200)*V(64))+C2*((-3D0)+(V(62)*V(65))/2D0)
  S(1)=2D0*(C(1)*V(146)+V(66)+V(68)*V(70))
  S(2)=2D0*(C(2)*V(146)+V(66)+V(70)*V(84))
  S(3)=2D0*(V(229)*V(65)+V(66)+V(70)*V(86))
  S(4)=C(4)*V(76)+V(70)*V(88)
  S(5)=C(5)*V(76)+V(70)*V(90)
  S(6)=V(191)*V(207)+V(192)*V(82)
  DSDC(1,1)=2D0*(V(146)+V(147)+C(1)*V(228)+V(138)*V(68))
  DSDC(1,2)=V(159)
  DSDC(1,3)=V(160)
  DSDC(1,4)=2D0*V(174)
  DSDC(1,5)=2D0*V(182)
  DSDC(1,6)=2D0*V(188)
  DSDC(2,1)=V(159)
  DSDC(2,2)=2D0*(-(C(2)*C2*V(102))+V(146)+V(149)+V(139)*V(84))
  DSDC(2,3)=V(163)
  DSDC(2,4)=2D0*V(175)
  DSDC(2,5)=2D0*V(183)
  DSDC(2,6)=2D0*V(189)
  DSDC(3,1)=V(160)
  DSDC(3,2)=V(163)
  DSDC(3,3)=2D0*(C2*V(103)*(-C(3)+V(200))+V(116)*V(87)+V(86)*(V(226)*V(96)+V(212)*(V(116)+V(117)*((-2D0)*C(3)+V(119))+V&
       &(222)*V(87)+V(124)*V(96))))
  DSDC(3,4)=2D0*V(176)
  DSDC(3,5)=2D0*V(184)
  DSDC(3,6)=2D0*V(190)
  DSDC(4,1)=V(174)
  DSDC(4,2)=V(175)
  DSDC(4,3)=V(176)
  DSDC(4,4)=V(201)*V(224)-2D0*V(230)+V(76)+V(141)*V(88)
  DSDC(4,5)=V(179)
  DSDC(4,6)=V(181)
  DSDC(5,1)=V(182)
  DSDC(5,2)=V(183)
  DSDC(5,3)=V(184)
  DSDC(5,4)=V(179)
  DSDC(5,5)=C(5)*V(111)-2D0*V(231)+V(76)+V(142)*V(90)
  DSDC(5,6)=V(187)
  DSDC(6,1)=V(188)
  DSDC(6,2)=V(189)
  DSDC(6,3)=V(190)
  DSDC(6,4)=V(181)
  DSDC(6,5)=V(187)
  DSDC(6,6)=2D0*V(191)+V(207)*(-(C(1)*V(143))-V(217))+V(232)*V(233)+V(192)*V(99)
END SUBROUTINE MOONERIVLIN

!--------------------
!*** VISCOBACKSTRESS
!--------------------
SUBROUTINE VISCOBACKSTRESS(DTIME,GAMMA,TAU,CE,SEHYPER,DSEHYPER,QOLD,QNEW,DQNEWDCE)
  IMPLICIT NONE
  DOUBLE PRECISION V(237),DTIME,GAMMA,TAU,CE(6),SEHYPER(6),DSEHYPER(6,6),QOLD(6),QNEW(6),DQNEWDCE(6,6)
  V(226)=2D0*SEHYPER(6)
  V(225)=CE(3)*DSEHYPER(3,6)
  V(224)=CE(2)*DSEHYPER(2,6)
  V(223)=CE(1)*DSEHYPER(1,6)
  V(222)=CE(4)*CE(5)
  V(221)=2D0*SEHYPER(5)
  V(220)=CE(3)*DSEHYPER(3,5)
  V(219)=CE(2)*DSEHYPER(2,5)
  V(218)=CE(1)*DSEHYPER(1,5)
  V(216)=CE(4)*CE(6)
  V(215)=2D0*SEHYPER(4)
  V(214)=CE(3)*DSEHYPER(3,4)
  V(213)=CE(2)*DSEHYPER(2,4)
  V(212)=CE(1)*DSEHYPER(1,4)
  V(210)=CE(3)*DSEHYPER(3,1)
  V(209)=CE(2)*DSEHYPER(2,1)
  V(208)=CE(1)*DSEHYPER(1,1)
  V(207)=CE(3)*DSEHYPER(3,2)
  V(206)=CE(2)*DSEHYPER(2,2)
  V(205)=CE(1)*DSEHYPER(1,2)
  V(203)=CE(3)*DSEHYPER(3,3)
  V(202)=CE(2)*DSEHYPER(2,3)
  V(201)=CE(1)*DSEHYPER(1,3)
  V(200)=2D0*CE(6)
  V(199)=2D0*CE(5)
  V(198)=2D0*CE(4)
  V(197)=CE(1)*SEHYPER(1)+CE(2)*SEHYPER(2)+CE(3)*SEHYPER(3)+SEHYPER(4)*V(198)+SEHYPER(5)*V(199)+SEHYPER(6)*V(200)
  V(211)=V(197)/3D0
  V(196)=CE(2)*CE(3)
  V(195)=DTIME*GAMMA
  V(194)=CE(6)**2
  V(193)=CE(5)*CE(6)
  V(192)=-(CE(3)*CE(4))+V(193)
  V(191)=-(CE(2)*CE(5))+V(216)
  V(190)=-(CE(1)*CE(6))+V(222)
  V(189)=CE(1)*CE(3)
  V(188)=CE(5)**2
  V(187)=CE(1)*CE(2)
  V(186)=CE(4)**2
  V(185)=1D0/(DTIME+TAU)
  V(123)=-V(186)+V(187)
  V(119)=-V(188)+V(189)
  V(126)=2D0*V(193)
  V(115)=CE(3)*V(123)+CE(4)*V(126)-CE(2)*V(188)-CE(1)*V(194)
  V(217)=(-1D0/3D0)*1D0/V(115)
  V(143)=V(195)/(3D0*V(115)**0.6666666666666666D0)
  V(229)=V(123)*V(143)
  V(228)=V(119)*V(143)
  V(134)=V(115)**0.3333333333333333D0*V(195)
  V(120)=1D0/V(115)**2
  V(114)=-V(194)+V(196)
  V(227)=V(114)*V(143)
  V(128)=V(120)*V(211)
  V(204)=3D0*V(128)
  V(125)=(-((SEHYPER(3)+DSEHYPER(4,3)*V(198)+DSEHYPER(5,3)*V(199)+DSEHYPER(6,3)*V(200)+V(201)+V(202)+V(203))/V(115))+V&
       &(123)*V(204))/3D0
  V(122)=(V(119)*V(204)-(SEHYPER(2)+DSEHYPER(4,2)*V(198)+DSEHYPER(5,2)*V(199)+DSEHYPER(6,2)*V(200)+V(205)+V(206)+V(207))&
       &/V(115))/3D0
  V(118)=(3D0*V(114)*V(128)-(SEHYPER(1)+DSEHYPER(4,1)*V(198)+DSEHYPER(5,1)*V(199)+DSEHYPER(6,1)*V(200)+V(208)+V(209)+V&
       &(210))/V(115))/3D0
  V(103)=-(V(211)/V(115))
  V(174)=-(CE(4)*V(103))
  V(171)=CE(6)*V(103)
  V(168)=CE(5)*V(103)
  V(153)=CE(1)*V(103)
  V(151)=CE(2)*V(103)
  V(144)=CE(3)*V(103)
  V(102)=SEHYPER(1)+V(103)*V(114)
  V(133)=V(102)*V(143)
  V(104)=SEHYPER(4)+V(103)*V(192)
  V(105)=SEHYPER(5)+V(103)*V(191)
  V(107)=SEHYPER(2)+V(103)*V(119)
  V(108)=SEHYPER(6)+V(103)*V(190)
  V(110)=SEHYPER(3)+V(103)*V(123)
  V(137)=V(126)-CE(3)*V(198)
  V(230)=V(137)*V(143)
  V(127)=V(128)*V(137)+(DSEHYPER(4,4)*V(198)+DSEHYPER(5,4)*V(199)+DSEHYPER(6,4)*V(200)+V(212)+V(213)+V(214)+V(215))*V(217&
       &)
  V(139)=-(CE(2)*V(199))+2D0*V(216)
  V(231)=V(139)*V(143)
  V(129)=V(128)*V(139)+V(217)*(DSEHYPER(4,5)*V(198)+DSEHYPER(5,5)*V(199)+DSEHYPER(6,5)*V(200)+V(218)+V(219)+V(220)+V(221)&
       &)
  V(141)=-(CE(1)*V(200))+2D0*V(222)
  V(232)=V(141)*V(143)
  V(130)=V(128)*V(141)+V(217)*(DSEHYPER(4,6)*V(198)+DSEHYPER(5,6)*V(199)+DSEHYPER(6,6)*V(200)+V(223)+V(224)+V(225)+V(226)&
       &)
  QNEW(1)=(QOLD(1)*TAU+V(102)*V(134))*V(185)
  QNEW(2)=(QOLD(2)*TAU+V(107)*V(134))*V(185)
  QNEW(3)=(QOLD(3)*TAU+V(110)*V(134))*V(185)
  QNEW(4)=(QOLD(4)*TAU+V(104)*V(134))*V(185)
  QNEW(5)=(QOLD(5)*TAU+V(105)*V(134))*V(185)
  QNEW(6)=(QOLD(6)*TAU+V(108)*V(134))*V(185)
  DQNEWDCE(1,1)=(V(114)*V(133)+(DSEHYPER(1,1)+V(114)*V(118))*V(134))*V(185)
  DQNEWDCE(1,2)=(V(119)*V(133)+V(134)*(DSEHYPER(1,2)+V(114)*V(122)+V(144)))*V(185)
  DQNEWDCE(1,3)=(V(123)*V(133)+V(134)*(DSEHYPER(1,3)+V(114)*V(125)+V(151)))*V(185)
  DQNEWDCE(1,4)=((DSEHYPER(1,4)+V(114)*V(127))*V(134)+V(133)*V(137))*V(185)
  DQNEWDCE(1,5)=((DSEHYPER(1,5)+V(114)*V(129))*V(134)+V(133)*V(139))*V(185)
  DQNEWDCE(1,6)=V(185)*(V(133)*V(141)+V(134)*(DSEHYPER(1,6)+V(114)*V(130)-V(103)*V(200)))
  DQNEWDCE(2,1)=V(185)*(V(134)*(DSEHYPER(2,1)+V(118)*V(119)+V(144))+V(107)*V(227))
  DQNEWDCE(2,2)=V(185)*((DSEHYPER(2,2)+V(119)*V(122))*V(134)+V(107)*V(228))
  DQNEWDCE(2,3)=V(185)*(V(134)*(DSEHYPER(2,3)+V(119)*V(125)+V(153))+V(107)*V(229))
  DQNEWDCE(2,4)=V(185)*((DSEHYPER(2,4)+V(119)*V(127))*V(134)+V(107)*V(230))
  DQNEWDCE(2,5)=V(185)*(V(134)*(DSEHYPER(2,5)+V(119)*V(129)-V(103)*V(199))+V(107)*V(231))
  DQNEWDCE(2,6)=V(185)*((DSEHYPER(2,6)+V(119)*V(130))*V(134)+V(107)*V(232))
  DQNEWDCE(3,1)=V(185)*(V(134)*(DSEHYPER(3,1)+V(118)*V(123)+V(151))+V(110)*V(227))
  DQNEWDCE(3,2)=V(185)*(V(134)*(DSEHYPER(3,2)+V(122)*V(123)+V(153))+V(110)*V(228))
  DQNEWDCE(3,3)=V(185)*((DSEHYPER(3,3)+V(123)*V(125))*V(134)+V(110)*V(229))
  DQNEWDCE(3,4)=V(185)*(V(134)*(DSEHYPER(3,4)+V(123)*V(127)-V(103)*V(198))+V(110)*V(230))
  DQNEWDCE(3,5)=V(185)*((DSEHYPER(3,5)+V(123)*V(129))*V(134)+V(110)*V(231))
  DQNEWDCE(3,6)=V(185)*((DSEHYPER(3,6)+V(123)*V(130))*V(134)+V(110)*V(232))
  DQNEWDCE(4,1)=V(185)*(V(134)*(DSEHYPER(4,1)+V(118)*V(192))+V(104)*V(227))
  DQNEWDCE(4,2)=V(185)*(V(134)*(DSEHYPER(4,2)+V(122)*V(192))+V(104)*V(228))
  DQNEWDCE(4,3)=V(185)*(V(134)*(DSEHYPER(4,3)+V(174)+V(125)*V(192))+V(104)*V(229))
  DQNEWDCE(4,4)=V(185)*(V(134)*(DSEHYPER(4,4)-V(144)+V(127)*V(192))+V(104)*V(230))
  DQNEWDCE(4,5)=V(185)*(V(134)*(DSEHYPER(4,5)+V(171)+V(129)*V(192))+V(104)*V(231))
  DQNEWDCE(4,6)=V(185)*(V(134)*(DSEHYPER(4,6)+V(168)+V(130)*V(192))+V(104)*V(232))
  DQNEWDCE(5,1)=V(185)*(V(134)*(DSEHYPER(5,1)+V(118)*V(191))+V(105)*V(227))
  DQNEWDCE(5,2)=V(185)*(V(134)*(DSEHYPER(5,2)-V(168)+V(122)*V(191))+V(105)*V(228))
  DQNEWDCE(5,3)=V(185)*(V(134)*(DSEHYPER(5,3)+V(125)*V(191))+V(105)*V(229))
  DQNEWDCE(5,4)=V(185)*(V(134)*(DSEHYPER(5,4)+V(171)+V(127)*V(191))+V(105)*V(230))
  DQNEWDCE(5,5)=V(185)*(V(134)*(DSEHYPER(5,5)-V(151)+V(129)*V(191))+V(105)*V(231))
  DQNEWDCE(5,6)=V(185)*(V(134)*(DSEHYPER(5,6)-V(174)+V(130)*V(191))+V(105)*V(232))
  DQNEWDCE(6,1)=V(185)*(V(134)*(DSEHYPER(6,1)-V(171)+V(118)*V(190))+V(108)*V(227))
  DQNEWDCE(6,2)=V(185)*(V(134)*(DSEHYPER(6,2)+V(122)*V(190))+V(108)*V(228))
  DQNEWDCE(6,3)=V(185)*(V(134)*(DSEHYPER(6,3)+V(125)*V(190))+V(108)*V(229))
  DQNEWDCE(6,4)=V(185)*(V(134)*(DSEHYPER(6,4)+V(168)+V(127)*V(190))+V(108)*V(230))
  DQNEWDCE(6,5)=V(185)*(V(134)*(DSEHYPER(6,5)-V(174)+V(129)*V(190))+V(108)*V(231))
  DQNEWDCE(6,6)=V(185)*(V(134)*(DSEHYPER(6,6)-V(153)+V(130)*V(190))+V(108)*V(232))
END SUBROUTINE VISCOBACKSTRESS


!**************************************************************
!* ACEGEN    6.808 LINUX (6 SEP 16)                           *
!*           CO. J. KORELC  2013           10 JAN 22 11:28:32 *
!**************************************************************
! USER     : FULL PROFESSIONAL VERSION
! NOTEBOOK : VISCOONETERM
! EVALUATION TIME                 : 91 S    MODE  : OPTIMAL
! NUMBER OF FORMULAE              : 80      METHOD: AUTOMATIC
! SUBROUTINE                      : VISCOONETERM SIZE: 2578
! TOTAL SIZE OF MATHEMATICA  CODE : 2578 SUBEXPRESSIONS
! TOTAL SIZE OF FORTRAN CODE      : 5889 BYTES
!******************* S U B R O U T I N E **********************
SUBROUTINE VISCOONETERM(CE,SEHYPER,DSEHYPER,QNEW,DQNEWDCE,SE,DSE)
  IMPLICIT NONE
  DOUBLE PRECISION V(291),CE(6),SEHYPER(6),DSEHYPER(6,6),QNEW(6),DQNEWDCE(6,6),SE(6),DSE(6,6)
  V(285)=2D0*QNEW(6)
  V(284)=CE(3)*DQNEWDCE(3,6)
  V(283)=CE(2)*DQNEWDCE(2,6)
  V(282)=CE(1)*DQNEWDCE(1,6)
  V(281)=CE(4)*CE(5)
  V(280)=2D0*QNEW(5)
  V(279)=CE(3)*DQNEWDCE(3,5)
  V(278)=CE(2)*DQNEWDCE(2,5)
  V(277)=CE(1)*DQNEWDCE(1,5)
  V(275)=CE(4)*CE(6)
  V(274)=2D0*QNEW(4)
  V(273)=CE(3)*DQNEWDCE(3,4)
  V(272)=CE(2)*DQNEWDCE(2,4)
  V(271)=CE(1)*DQNEWDCE(1,4)
  V(269)=CE(3)*DQNEWDCE(3,1)
  V(268)=CE(2)*DQNEWDCE(2,1)
  V(267)=CE(1)*DQNEWDCE(1,1)
  V(266)=CE(3)*DQNEWDCE(3,2)
  V(265)=CE(2)*DQNEWDCE(2,2)
  V(264)=CE(1)*DQNEWDCE(1,2)
  V(262)=CE(3)*DQNEWDCE(3,3)
  V(261)=CE(2)*DQNEWDCE(2,3)
  V(260)=CE(1)*DQNEWDCE(1,3)
  V(259)=2D0*CE(6)
  V(258)=2D0*CE(5)
  V(257)=2D0*CE(4)
  V(256)=CE(1)*QNEW(1)+CE(2)*QNEW(2)+CE(3)*QNEW(3)+QNEW(4)*V(257)+QNEW(5)*V(258)+QNEW(6)*V(259)
  V(270)=V(256)/3D0
  V(255)=CE(2)*CE(3)
  V(254)=CE(6)**2
  V(253)=CE(5)*CE(6)
  V(252)=-(CE(3)*CE(4))+V(253)
  V(251)=-(CE(2)*CE(5))+V(275)
  V(250)=-(CE(1)*CE(6))+V(281)
  V(249)=CE(1)*CE(3)
  V(248)=CE(5)**2
  V(247)=CE(1)*CE(2)
  V(246)=CE(4)**2
  V(157)=-V(246)+V(247)
  V(156)=-V(248)+V(249)
  V(158)=2D0*V(253)
  V(155)=-V(254)+V(255)
  V(144)=CE(3)*V(157)+CE(4)*V(158)-CE(2)*V(248)-CE(1)*V(254)
  V(276)=(-1D0/3D0)*1D0/V(144)
  V(172)=1D0/V(144)**2
  V(163)=1D0/V(144)**0.13333333333333333D1
  V(286)=(-1D0/3D0)*V(163)
  V(146)=1D0/V(144)**0.3333333333333333D0
  V(178)=V(172)*V(270)
  V(263)=3D0*V(178)
  V(176)=(-((QNEW(3)+DQNEWDCE(4,3)*V(257)+DQNEWDCE(5,3)*V(258)+DQNEWDCE(6,3)*V(259)+V(260)+V(261)+V(262))/V(144))+V(157&
       &)*V(263))/3D0
  V(174)=(V(156)*V(263)-(QNEW(2)+DQNEWDCE(4,2)*V(257)+DQNEWDCE(5,2)*V(258)+DQNEWDCE(6,2)*V(259)+V(264)+V(265)+V(266))/V&
       &(144))/3D0
  V(171)=(3D0*V(155)*V(178)-(QNEW(1)+DQNEWDCE(4,1)*V(257)+DQNEWDCE(5,1)*V(258)+DQNEWDCE(6,1)*V(259)+V(267)+V(268)+V(269))&
       &/V(144))/3D0
  V(136)=-(V(270)/V(144))
  V(236)=-(CE(4)*V(136))
  V(229)=-(CE(5)*V(136))
  V(227)=-(CE(6)*V(136))
  V(190)=CE(1)*V(136)
  V(188)=CE(2)*V(136)
  V(184)=CE(3)*V(136)
  V(135)=QNEW(1)+V(136)*V(155)
  V(137)=QNEW(4)+V(136)*V(252)
  V(138)=QNEW(5)+V(136)*V(251)
  V(140)=QNEW(2)+V(136)*V(156)
  V(141)=QNEW(6)+V(136)*V(250)
  V(143)=QNEW(3)+V(136)*V(157)
  V(159)=V(158)-CE(3)*V(257)
  V(177)=V(159)*V(178)+(DQNEWDCE(4,4)*V(257)+DQNEWDCE(5,4)*V(258)+DQNEWDCE(6,4)*V(259)+V(271)+V(272)+V(273)+V(274))*V(276&
       &)
  V(160)=-(CE(2)*V(258))+2D0*V(275)
  V(179)=V(160)*V(178)+V(276)*(DQNEWDCE(4,5)*V(257)+DQNEWDCE(5,5)*V(258)+DQNEWDCE(6,5)*V(259)+V(277)+V(278)+V(279)+V(280)&
       &)
  V(161)=-(CE(1)*V(259))+2D0*V(281)
  V(180)=V(161)*V(178)+V(276)*(DQNEWDCE(4,6)*V(257)+DQNEWDCE(5,6)*V(258)+DQNEWDCE(6,6)*V(259)+V(282)+V(283)+V(284)+V(285)&
       &)
  V(162)=V(155)*V(286)
  V(164)=V(156)*V(286)
  V(165)=V(157)*V(286)
  V(166)=V(159)*V(286)
  V(167)=V(160)*V(286)
  V(168)=V(161)*V(286)
  SE(1)=SEHYPER(1)-V(135)*V(146)
  SE(2)=SEHYPER(2)-V(140)*V(146)
  SE(3)=SEHYPER(3)-V(143)*V(146)
  SE(4)=SEHYPER(4)-V(137)*V(146)
  SE(5)=SEHYPER(5)-V(138)*V(146)
  SE(6)=SEHYPER(6)-V(141)*V(146)
  DSE(1,1)=DSEHYPER(1,1)-V(135)*V(162)-V(146)*(DQNEWDCE(1,1)+V(155)*V(171))
  DSE(1,2)=DSEHYPER(1,2)-V(135)*V(164)-V(146)*(DQNEWDCE(1,2)+V(155)*V(174)+V(184))
  DSE(1,3)=DSEHYPER(1,3)-V(135)*V(165)-V(146)*(DQNEWDCE(1,3)+V(155)*V(176)+V(188))
  DSE(1,4)=DSEHYPER(1,4)-V(135)*V(166)-V(146)*(DQNEWDCE(1,4)+V(155)*V(177))
  DSE(1,5)=DSEHYPER(1,5)-V(135)*V(167)-V(146)*(DQNEWDCE(1,5)+V(155)*V(179))
  DSE(1,6)=DSEHYPER(1,6)-V(135)*V(168)-V(146)*(DQNEWDCE(1,6)+V(155)*V(180)-V(136)*V(259))
  DSE(2,1)=DSEHYPER(2,1)-V(140)*V(162)-V(146)*(DQNEWDCE(2,1)+V(156)*V(171)+V(184))
  DSE(2,2)=DSEHYPER(2,2)-V(140)*V(164)-V(146)*(DQNEWDCE(2,2)+V(156)*V(174))
  DSE(2,3)=DSEHYPER(2,3)-V(140)*V(165)-V(146)*(DQNEWDCE(2,3)+V(156)*V(176)+V(190))
  DSE(2,4)=DSEHYPER(2,4)-V(140)*V(166)-V(146)*(DQNEWDCE(2,4)+V(156)*V(177))
  DSE(2,5)=DSEHYPER(2,5)-V(140)*V(167)-V(146)*(DQNEWDCE(2,5)+V(156)*V(179)-V(136)*V(258))
  DSE(2,6)=DSEHYPER(2,6)-V(140)*V(168)-V(146)*(DQNEWDCE(2,6)+V(156)*V(180))
  DSE(3,1)=DSEHYPER(3,1)-V(143)*V(162)-V(146)*(DQNEWDCE(3,1)+V(157)*V(171)+V(188))
  DSE(3,2)=DSEHYPER(3,2)-V(143)*V(164)-V(146)*(DQNEWDCE(3,2)+V(157)*V(174)+V(190))
  DSE(3,3)=DSEHYPER(3,3)-V(143)*V(165)-V(146)*(DQNEWDCE(3,3)+V(157)*V(176))
  DSE(3,4)=DSEHYPER(3,4)-V(143)*V(166)-V(146)*(DQNEWDCE(3,4)+V(157)*V(177)-V(136)*V(257))
  DSE(3,5)=DSEHYPER(3,5)-V(143)*V(167)-V(146)*(DQNEWDCE(3,5)+V(157)*V(179))
  DSE(3,6)=DSEHYPER(3,6)-V(143)*V(168)-V(146)*(DQNEWDCE(3,6)+V(157)*V(180))
  DSE(4,1)=DSEHYPER(4,1)-V(137)*V(162)-V(146)*(DQNEWDCE(4,1)+V(171)*V(252))
  DSE(4,2)=DSEHYPER(4,2)-V(137)*V(164)-V(146)*(DQNEWDCE(4,2)+V(174)*V(252))
  DSE(4,3)=DSEHYPER(4,3)-V(137)*V(165)-V(146)*(DQNEWDCE(4,3)+V(236)+V(176)*V(252))
  DSE(4,4)=DSEHYPER(4,4)-V(137)*V(166)-V(146)*(DQNEWDCE(4,4)-V(184)+V(177)*V(252))
  DSE(4,5)=DSEHYPER(4,5)-V(137)*V(167)-V(146)*(DQNEWDCE(4,5)-V(227)+V(179)*V(252))
  DSE(4,6)=DSEHYPER(4,6)-V(137)*V(168)-V(146)*(DQNEWDCE(4,6)-V(229)+V(180)*V(252))
  DSE(5,1)=DSEHYPER(5,1)-V(138)*V(162)-V(146)*(DQNEWDCE(5,1)+V(171)*V(251))
  DSE(5,2)=DSEHYPER(5,2)-V(138)*V(164)-V(146)*(DQNEWDCE(5,2)+V(229)+V(174)*V(251))
  DSE(5,3)=DSEHYPER(5,3)-V(138)*V(165)-V(146)*(DQNEWDCE(5,3)+V(176)*V(251))
  DSE(5,4)=DSEHYPER(5,4)-V(138)*V(166)-V(146)*(DQNEWDCE(5,4)-V(227)+V(177)*V(251))
  DSE(5,5)=DSEHYPER(5,5)-V(138)*V(167)-V(146)*(DQNEWDCE(5,5)-V(188)+V(179)*V(251))
  DSE(5,6)=DSEHYPER(5,6)-V(138)*V(168)-V(146)*(DQNEWDCE(5,6)-V(236)+V(180)*V(251))
  DSE(6,1)=DSEHYPER(6,1)-V(141)*V(162)-V(146)*(DQNEWDCE(6,1)+V(227)+V(171)*V(250))
  DSE(6,2)=DSEHYPER(6,2)-V(141)*V(164)-V(146)*(DQNEWDCE(6,2)+V(174)*V(250))
  DSE(6,3)=DSEHYPER(6,3)-V(141)*V(165)-V(146)*(DQNEWDCE(6,3)+V(176)*V(250))
  DSE(6,4)=DSEHYPER(6,4)-V(141)*V(166)-V(146)*(DQNEWDCE(6,4)-V(229)+V(177)*V(250))
  DSE(6,5)=DSEHYPER(6,5)-V(141)*V(167)-V(146)*(DQNEWDCE(6,5)-V(236)+V(179)*V(250))
  DSE(6,6)=DSEHYPER(6,6)-V(141)*V(168)-V(146)*(DQNEWDCE(6,6)-V(190)+V(180)*V(250))
END SUBROUTINE VISCOONETERM






